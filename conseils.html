<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conseils - Workout History</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="workouts.html">Workouts</a></li>
            <li><a href="conseils.html" class="active">Conseils</a></li>
        </ul>
    </nav>

    <main class="conseils-container">
        <h1>Conseils Automatiques</h1>
        <p class="conseil-description">Conseils quotidiens provenant de sources fiables et v√©rifi√©es</p>

        <!-- Div o√π les conseils seront inject√©s dynamiquement -->
        <div id="conseilsList" class="conseils-list">
            <!-- Les conseils seront ajout√©s ici par JavaScript -->
        </div>
    </main>

    <script>
        // Fonction principale qui charge les conseils depuis l'API
        async function loadConseils() {
            try {
                console.log('Chargement des conseils...');
                // Appel √† l'API en utilisant une URL relative
                const response = await fetch('/api/conseils', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                // V√©rification si la requ√™te a r√©ussi
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                // Conversion de la r√©ponse en JSON
                const conseils = await response.json();
                console.log('Conseils re√ßus:', conseils);

                const conseilsList = document.getElementById('conseilsList');

                // Si aucun conseil n'est disponible
                if (!conseils || conseils.length === 0) {
                    conseilsList.innerHTML = '<p>Aucun conseil disponible pour le moment.</p>';
                    return;
                }

                // Cr√©ation des cartes de conseils avec les donn√©es re√ßues
                conseilsList.innerHTML = conseils.map(conseil => `
                    <article class="conseil-card ${conseil.type}">
                        <div class="conseil-header">
                            <span class="date">${conseil.date || 'Date non disponible'}</span>
                            <!-- Emoji diff√©rent selon le type de conseil -->
                            <span class="type">${conseil.type === 'sport' ? 'üèÉ‚Äç‚ôÇÔ∏è Sport' : 'üìö Travail'}</span>
                        </div>
                        <h3>${conseil.titre || 'Sans titre'}</h3>
                        <p>${conseil.contenu || 'Pas de contenu disponible'}</p>
                        <div class="conseil-footer">
                            <small>Source: ${conseil.source ?
                        `<a href="${conseil.source}" target="_blank">${conseil.source}</a>`
                        : 'Source non disponible'}</small>
                        </div>
                    </article>
                `).join('');
            } catch (error) {
                // Gestion des erreurs avec message explicite
                console.error('Erreur d√©taill√©e:', error);
                const errorMessage = `Erreur: ${error.message}. V√©rifiez que le serveur est bien lanc√© sur le port 3001.`;
                document.getElementById('conseilsList').innerHTML =
                    `<p class="error-message">${errorMessage}</p>`;
            }
        }

        // Chargement des conseils quand la page est pr√™te
        document.addEventListener('DOMContentLoaded', loadConseils);
    </script>
</body>

</html>